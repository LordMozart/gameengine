<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D FPS Game</title>
    <style>
        body, html { margin: 0; padding: 0; overflow: hidden; height: 100%; background-color: #000; }
        canvas { display: block; }
        .hud {
            position: absolute; top: 10px; left: 10px; color: white; font-family: Arial, sans-serif; font-size: 18px;
        }
        #ammo, #score, #health, #reload {
            display: block;
        }
        #reload { font-size: 16px; color: red; }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div class="hud">
        <span id="ammo">Ammo: 10</span>
        <span id="score">Score: 0</span>
        <span id="health">Health: 100</span>
        <span id="reload">Press R to Reload</span>
    </div>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let player = {
            x: 200, y: 200, z: 100, pitch: 0, yaw: 0, health: 100, ammo: 10, speed: 2, jump: false, jumpHeight: 0
        };
        let bullets = [];
        let enemies = [{ x: 600, y: 200, z: 100, health: 50 }];
        let score = 0;
        let walls = [
            { x: 400, y: 200, z: 300, w: 500, h: 10, d: 500 }, // Floor
            { x: 400, y: 200, z: 0, w: 500, h: 10, d: 500 }, // Ceiling
            { x: 0, y: 200, z: 300, w: 10, h: 500, d: 500 }, // Left wall
            { x: 800, y: 200, z: 300, w: 10, h: 500, d: 500 }, // Right wall
            { x: 400, y: 200, z: 0, w: 500, h: 500, d: 10 }, // Front wall
            { x: 400, y: 200, z: 600, w: 500, h: 500, d: 10 }  // Back wall
        ];

        const gravity = 0.05;
        const maxJumpHeight = 50;

        let keys = { w: false, a: false, s: false, d: false, space: false, r: false };
        window.addEventListener('keydown', (e) => { keys[e.key] = true; });
        window.addEventListener('keyup', (e) => { keys[e.key] = false; });

        let mouseX = 0, mouseY = 0;
        canvas.addEventListener('mousemove', (e) => {
            mouseX = e.clientX;
            mouseY = e.clientY;
        });

        canvas.addEventListener('click', () => {
            if (player.ammo > 0) fireBullet();
            else alert('Out of ammo! Press "R" to reload.');
        });

        function fireBullet() {
            bullets.push({
                x: player.x,
                y: player.y,
                z: player.z,
                dx: Math.sin(player.yaw),
                dy: Math.sin(player.pitch),
                dz: Math.cos(player.yaw),
                speed: 5
            });
            player.ammo--;
            updateHUD();
        }

        function updateHUD() {
            document.getElementById('ammo').textContent = `Ammo: ${player.ammo}`;
            document.getElementById('score').textContent = `Score: ${score}`;
            document.getElementById('health').textContent = `Health: ${player.health}`;
        }

        function reload() {
            if (keys.r) {
                player.ammo = 10;
                updateHUD();
            }
        }

        function movePlayer() {
            if (keys.w) { player.x += Math.sin(player.yaw) * player.speed; player.z -= Math.cos(player.yaw) * player.speed; }
            if (keys.s) { player.x -= Math.sin(player.yaw) * player.speed; player.z += Math.cos(player.yaw) * player.speed; }
            if (keys.a) { player.x -= Math.cos(player.yaw) * player.speed; player.z -= Math.sin(player.yaw) * player.speed; }
            if (keys.d) { player.x += Math.cos(player.yaw) * player.speed; player.z += Math.sin(player.yaw) * player.speed; }

            if (keys.space && !player.jump) {
                player.jump = true;
                player.jumpHeight = 10;
            }
        }

        function handleJump() {
            if (player.jump) {
                player.y += player.jumpHeight;
                player.jumpHeight -= gravity;
                if (player.y <= 200) {
                    player.y = 200;
                    player.jump = false;
                    player.jumpHeight = 0;
                }
            }
        }

        function checkCollisions() {
            bullets.forEach((bullet, index) => {
                enemies.forEach((enemy, enemyIndex) => {
                    let distance = Math.sqrt(Math.pow(bullet.x - enemy.x, 2) + Math.pow(bullet.y - enemy.y, 2) + Math.pow(bullet.z - enemy.z, 2));
                    if (distance < 10) {
                        score++;
                        enemies.splice(enemyIndex, 1);
                        bullets.splice(index, 1);
                    }
                });

                walls.forEach(wall => {
                    if (bullet.x > wall.x && bullet.x < wall.x + wall.w && bullet.y > wall.y && bullet.y < wall.y + wall.h && bullet.z > wall.z && bullet.z < wall.z + wall.d) {
                        bullets.splice(index, 1);
                    }
                });
            });
        }

        function moveBullets() {
            bullets.forEach(bullet => {
                bullet.x += bullet.dx * bullet.speed;
                bullet.y += bullet.dy * bullet.speed;
                bullet.z += bullet.dz * bullet.speed;
            });
        }

        function renderWalls() {
            walls.forEach(wall => {
                ctx.fillStyle = '#999';
                ctx.fillRect(wall.x, wall.z, wall.w, wall.d);
            });
        }

        function renderEnemies() {
            enemies.forEach(enemy => {
                ctx.beginPath();
                ctx.arc(enemy.x, enemy.z, 10, 0, Math.PI * 2);
                ctx.fillStyle = '#ff0000';
                ctx.fill();
            });
        }

        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            movePlayer();
            handleJump();
            reload();

            moveBullets();
            checkCollisions();

            renderWalls();
            renderEnemies();

            updateHUD();
            requestAnimationFrame(update);
        }

        update();
    </script>
</body>
</html>

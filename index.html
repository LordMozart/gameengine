<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D FPS Game</title>
    <style>
        body, html { margin: 0; padding: 0; overflow: hidden; height: 100%; }
        canvas { display: block; }
        .hud { position: absolute; top: 10px; left: 10px; color: white; font-family: Arial, sans-serif; font-size: 18px; }
        .hud span { display: block; }
        #reload { font-size: 16px; color: #ff0000; }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div class="hud">
        <span id="ammo">Ammo: 10</span>
        <span id="score">Score: 0</span>
        <span id="health">Health: 100</span>
        <span id="reload">Press R to Reload</span>
    </div>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // Player and game variables
        let player = { x: 200, y: 200, z: 100, pitch: 0, yaw: 0, health: 100, ammo: 10, speed: 2, jump: false, jumpHeight: 0 };
        let bullets = [];
        let enemies = [{ x: 600, y: 200, z: 100, health: 50 }];
        let score = 0;
        let walls = [
            { x: 400, y: 200, z: 300, w: 500, h: 10, d: 500 }, // Floor
            { x: 400, y: 200, z: 0, w: 500, h: 10, d: 500 }, // Ceiling
            { x: 0, y: 200, z: 300, w: 10, h: 500, d: 500 }, // Left wall
            { x: 800, y: 200, z: 300, w: 10, h: 500, d: 500 }, // Right wall
            { x: 400, y: 200, z: 0, w: 500, h: 500, d: 10 }, // Front wall
            { x: 400, y: 200, z: 600, w: 500, h: 500, d: 10 }, // Back wall
        ];

        // Game settings
        const gravity = 0.05;
        const maxJumpHeight = 50;

        // Key and mouse controls
        let keys = { w: false, a: false, s: false, d: false, space: false, r: false };
        window.addEventListener('keydown', (e) => { keys[e.key] = true; });
        window.addEventListener('keyup', (e) => { keys[e.key] = false; });

        let mouseX = 0, mouseY = 0;
        canvas.addEventListener('mousemove', (e) => {
            mouseX = e.clientX;
            mouseY = e.clientY;
        });

        // Bullet and shooting mechanics
        canvas.addEventListener('click', () => {
            if (player.ammo > 0) {
                fireBullet();
            } else {
                alert('Out of ammo! Press "R" to reload.');
            }
        });

        function fireBullet() {
            bullets.push({
                x: player.x,
                y: player.y,
                z: player.z,
                dx: Math.sin(player.yaw),
                dy: Math.sin(player.pitch),
                dz: Math.cos(player.yaw),
                speed: 5
            });
            player.ammo--;
            updateHUD();
        }

        // Update ammo counter
        function updateHUD() {
            document.getElementById('ammo').textContent = `Ammo: ${player.ammo}`;
            document.getElementById('score').textContent = `Score: ${score}`;
            document.getElementById('health').textContent = `Health: ${player.health}`;
        }

        // Reload function
        function reload() {
            if (keys.r) {
                player.ammo = 10;
                updateHUD();
            }
        }

        // Move player based on WASD and jumping
        function movePlayer() {
            if (keys.w) { player.x += Math.sin(player.yaw) * player.speed; player.z -= Math.cos(player.yaw) * player.speed; }
            if (keys.s) { player.x -= Math.sin(player.yaw) * player.speed; player.z += Math.cos(player.yaw) * player.speed; }
            if (keys.a) { player.x -= Math.cos(player.yaw) * player.speed; player.z -= Math.sin(player.yaw) * player.speed; }
            if (keys.d) { player.x += Math.cos(player.yaw) * player.speed; player.z += Math.sin(player.yaw) * player.speed; }

            if (keys.space && !player.jump) {
                player.jump = true;
                player.jumpHeight = 10;
            }
        }

        // Update player's jump (gravity effect)
        function handleJump() {
            if (player.jump) {
                player.y += player.jumpHeight;
                player.jumpHeight -= gravity;
                if (player.y <= 200) {  // Reset when reaching the ground
                    player.y = 200;
                    player.jump = false;
                    player.jumpHeight = 0;
                }
            }
        }

        // Check bullet collisions
        function checkCollisions() {
            bullets.forEach((bullet, index) => {
                enemies.forEach((enemy, enemyIndex) => {
                    let distance = Math.sqrt(Math.pow(bullet.x - enemy.x, 2) + Math.pow(bullet.y - enemy.y, 2) + Math.pow(bullet.z - enemy.z, 2));
                    if (distance < 10) {
                        score++;
                        enemies.splice(enemyIndex, 1);  // Remove enemy
                        bullets.splice(index, 1);  // Remove bullet
                    }
                });

                walls.forEach(wall => {
                    if (bullet.x > wall.x && bullet.x < wall.x + wall.w && bullet.y > wall.y && bullet.y < wall.y + wall.h && bullet.z > wall.z && bullet.z < wall.z + wall.d) {
                        bullets.splice(index, 1);  // Remove bullet when hitting wall
                    }
                });
            });
        }

        // Move bullets
        function moveBullets() {
            bullets.forEach(bullet => {
                bullet.x += bullet.dx * bullet.speed;
                bullet.y += bullet.dy * bullet.speed;
                bullet.z += bullet.dz * bullet.speed;
            });
        }

        // Render environment (walls and floor)
        function renderWalls() {
            walls.forEach(wall => {
                ctx.fillStyle = '#999';
                ctx.fillRect(wall.x, wall.z, wall.w, wall.d);  // Basic 2D projection for simplicity
            });
        }

        // Render enemies
        function renderEnemies() {
            enemies.forEach(enemy => {
                ctx.beginPath();
                ctx.arc(enemy.x, enemy.z, 10, 0, Math.PI * 2);
                ctx.fillStyle = '#ff0000';
                ctx.fill();
            });
        }

        // Handle game update loop
        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Update player movement
            movePlayer();
            handleJump();
            reload();

            // Move and check bullets
            moveBullets();
            checkCollisions();

            // Render the game world
            renderWalls();
            renderEnemies();

            // Update the HUD
            updateHUD();

            // Continue the game loop
            requestAnimationFrame(update);
        }

        // Start game
        update();
    </script>
</body>
</html>
